/* solaredge-client@1.0.0 (ISC) — https://github.com/shaungrady/solaredge-client */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SolaredgeClient={})}(this,(function(e){"use strict";var t=function(){return(t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function r(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))}function n(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function a(e){return this instanceof a?(this.v=e,this):new a(e)}function i(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||c(e,t)}))})}function c(e,t){try{(r=i[e](t)).value instanceof a?Promise.resolve(r.value.v).then(u,l):f(o[0][2],r)}catch(e){f(o[0][3],e)}var r}function u(e){c("next",e)}function l(e){c("throw",e)}function f(e,t){e(t),o.shift(),o.length&&c(o[0][0],o[0][1])}}function o(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function s(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function c(e){s(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function u(e,t){s(2,arguments);var r=c(e),n=o(t);return isNaN(n)?new Date(NaN):n?(r.setDate(r.getDate()+n),r):r}function l(e,t){s(2,arguments);var r=c(e),n=o(t);if(isNaN(n))return new Date(NaN);if(!n)return r;var a=r.getDate(),i=new Date(r.getTime());i.setMonth(r.getMonth()+n+1,0);var u=i.getDate();return a>=u?i:(r.setFullYear(i.getFullYear(),i.getMonth(),a),r)}function f(e,t){if(s(2,arguments),!t||"object"!=typeof t)return new Date(NaN);var r="years"in t?o(t.years):0,n="months"in t?o(t.months):0,a="weeks"in t?o(t.weeks):0,i="days"in t?o(t.days):0,f="hours"in t?o(t.hours):0,p="minutes"in t?o(t.minutes):0,h="seconds"in t?o(t.seconds):0,y=c(e),d=n||r?l(y,n+12*r):y,g=i||a?u(d,i+7*a):d,m=p+60*f,v=h+60*m,b=1e3*v,w=new Date(g.getTime()+b);return w}function p(e,t){s(2,arguments);var r=c(e).getTime(),n=o(t);return new Date(r+n)}function h(e){return e.getTime()%6e4}function y(e){var t=new Date(e.getTime()),r=Math.ceil(t.getTimezoneOffset());return t.setSeconds(0,0),6e4*r+(r>0?(6e4+h(t))%6e4:h(t))}function d(e){s(1,arguments);var t=c(e);return!isNaN(t)}function g(e,t){s(2,arguments);var r=o(t);return p(e,-r)}function m(e,t){for(var r=e<0?"-":"",n=Math.abs(e).toString();n.length<t;)n="0"+n;return r+n}var v={y:function(e,t){var r=e.getUTCFullYear(),n=r>0?r:1-r;return m("yy"===t?n%100:n,t.length)},M:function(e,t){var r=e.getUTCMonth();return"M"===t?String(r+1):m(r+1,2)},d:function(e,t){return m(e.getUTCDate(),t.length)},a:function(e,t){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":case"aaa":return r.toUpperCase();case"aaaaa":return r[0];case"aaaa":default:return"am"===r?"a.m.":"p.m."}},h:function(e,t){return m(e.getUTCHours()%12||12,t.length)},H:function(e,t){return m(e.getUTCHours(),t.length)},m:function(e,t){return m(e.getUTCMinutes(),t.length)},s:function(e,t){return m(e.getUTCSeconds(),t.length)},S:function(e,t){var r=t.length,n=e.getUTCMilliseconds();return m(Math.floor(n*Math.pow(10,r-3)),t.length)}};function b(e,t){s(2,arguments);var r=c(e),n=c(t);return r.getTime()<n.getTime()}var w=/(\w)\1*|''|'(''|[^'])+('|$)|./g,j=/^'([^]*?)'?$/,T=/''/g,O=/[a-zA-Z]/;function S(e,t){s(2,arguments);var r=String(t),n=c(e);if(!d(n))throw new RangeError("Invalid time value");var a=y(n),i=g(n,a),o=r.match(w).map((function(e){if("''"===e)return"'";var t=e[0];if("'"===t)return D(e);var r=v[t];if(r)return r(i,e,null,{});if(t.match(O))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return e})).join("");return o}function D(e){return e.match(j)[1].replace(T,"'")}function N(e){var t,r;if(s(1,arguments),e&&"function"==typeof e.forEach)t=e;else{if("object"!=typeof e||null===e)return new Date(NaN);t=Array.prototype.slice.call(e)}return t.forEach((function(e){var t=c(e);(void 0===r||r>t||isNaN(t))&&(r=t)})),r||new Date(NaN)}var x=new RegExp("%[a-f0-9]{2}","gi"),R=new RegExp("(%[a-f0-9]{2})+","gi");function F(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],F(r),F(n))}function k(e){try{return decodeURIComponent(e)}catch(n){for(var t=e.match(x),r=1;r<t.length;r++)t=(e=F(t,r).join("")).match(x);return e}}var E,U=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=R.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var n=k(r[0]);n!==r[0]&&(t[r[0]]=n)}r=R.exec(e)}t["%C2"]="�";for(var a=Object.keys(t),i=0;i<a.length;i++){var o=a[i];e=e.replace(new RegExp(o,"g"),t[o])}return e}(e)}},C=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const r=e.indexOf(t);return-1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]},P=function(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}((function(e,t){function r(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function n(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function a(e,t){return t.decode?U(e):e}function i(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function o(e){const t=(e=i(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function s(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){r((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const i="string"==typeof r&&r.split("").indexOf(e.arrayFormatSeparator)>-1?r.split(e.arrayFormatSeparator).map(t=>a(t,e)):null===r?r:a(r,e);n[t]=i};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t),i=Object.create(null);if("string"!=typeof e)return i;if(!(e=e.trim().replace(/^[?#&]/,"")))return i;for(const r of e.split("&")){let[e,o]=C(t.decode?r.replace(/\+/g," "):r,"=");o=void 0===o?null:["comma","separator"].includes(t.arrayFormat)?o:a(o,t),n(a(e,t),o,i)}for(const e of Object.keys(i)){const r=i[e];if("object"==typeof r&&null!==r)for(const e of Object.keys(r))r[e]=s(r[e],t);else i[e]=s(r,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce((e,t)=>{const r=i[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(r):e[t]=r,e},Object.create(null))}t.extract=o,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";r((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const a=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],i=function(e){switch(e.arrayFormat){case"index":return t=>(r,a)=>{const i=r.length;return void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?r:null===a?[...r,[n(t,e),"[",i,"]"].join("")]:[...r,[n(t,e),"[",n(i,e),"]=",n(a,e)].join("")]};case"bracket":return t=>(r,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?r:null===a?[...r,[n(t,e),"[]"].join("")]:[...r,[n(t,e),"[]=",n(a,e)].join("")];case"comma":case"separator":return t=>(r,a)=>null==a||0===a.length?r:0===r.length?[[n(t,e),"=",n(a,e)].join("")]:[[r,n(a,e)].join(e.arrayFormatSeparator)];default:return t=>(r,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?r:null===a?[...r,n(t,e)]:[...r,[n(t,e),"=",n(a,e)].join("")]}}(t),o={};for(const t of Object.keys(e))a(t)||(o[t]=e[t]);const s=Object.keys(o);return!1!==t.sort&&s.sort(t.sort),s.map(r=>{const a=e[r];return void 0===a?"":null===a?n(r,t):Array.isArray(a)?a.reduce(i(r),[]).join("&"):n(r,t)+"="+n(a,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[r,n]=C(e,"#");return Object.assign({url:r.split("?")[0]||"",query:c(o(e),t)},t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:a(n,t)}:{})},t.stringifyUrl=(e,r)=>{r=Object.assign({encode:!0,strict:!0},r);const a=i(e.url).split("?")[0]||"",o=t.extract(e.url),s=t.parse(o,{sort:!1}),c=Object.assign(s,e.query);let u=t.stringify(c,r);u&&(u="?"+u);let l=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(e.url);return e.fragmentIdentifier&&(l="#"+n(e.fragmentIdentifier,r)),`${a}${u}${l}`}}));function I(e,t){return Number(e)-Number(t)}(E=e.RangeType||(e.RangeType={}))[E.Date=0]="Date",E[E.DateTime=1]="DateTime";var M=function(){function o(e,r){if(void 0===r&&(r={}),this.key=e,!o.isValidApiKey(e))throw Error("Invalid API key; must be a 32-character uppercase alphanumeric string.");this.config=Object.freeze(t({origin:o.defaultOrigin},r))}return o.isValidApiKey=function(e){return/^[A-Z0-9]{32}$/.test(e)},o.serializeDate=function(e){return S(e,o.dateFormat)},o.serializeDateTime=function(e){return S(e,o.dateTimeFormat)},o.parseDateOrTimeRange=function(t){var r,n,a,i,o;return"dateRange"in t?(i=(r=t.dateRange.slice().sort(I))[0],o=r[1],a=e.RangeType.Date):(i=(n=t.timeRange.slice().sort(I))[0],o=n[1],a=e.RangeType.DateTime),{type:a,start:i,end:o}},o.serializeRange=function(t){var r=t.type,n=t.start,a=t.end;return r===e.RangeType.Date?{startDate:o.serializeDate(n),endDate:o.serializeDate(a)}:{startTime:o.serializeDateTime(n),endTime:o.serializeDateTime(a)}},o.prototype.call=function(e,a){return void 0===a&&(a={}),r(this,void 0,void 0,(function(){var r,i,o,s,c,u,l,f,p;return n(this,(function(n){switch(n.label){case 0:return i=(r=this).key,o=r.config,s=t({params:{}},a),c={Accept:"application/json"},u=P.stringify(t(t({},s.params),{api_key:i})),l=""+o.origin+e+"?"+u,[4,fetch(l,{headers:c})];case 1:return[4,n.sent().json()];case 2:return f=n.sent(),[2,1===(p=Object.values(f)).length?p[0]:f]}}))}))},o.prototype.callGenerator=function(e){return i(this,arguments,(function(){var r,i,s,c,u,l,p,h,y,d,g,m,v,w,j,T;return n(this,(function(n){switch(n.label){case 0:r=e.apiPath,i=e.interval,s=e.parser,c=this.call.bind(this),u={config:e,apiCallTotal:0,recordTotal:0},l="timeUnit"in e&&e.timeUnit,p=o.parseDateOrTimeRange(e),h=p.start,n.label=1;case 1:return b(h,p.end)?(y=N([p.end,f(h,i)]),d=l?{timeUnit:l}:{},g=o.serializeRange({type:p.type,start:h,end:y}),[4,a(c(r,{params:t(t({},g),d)}))]):[3,8];case 2:m=n.sent(),v=s(m),w=0,j=v,n.label=3;case 3:return w<j.length?(T=j[w],u.recordTotal+=1,[4,a(T)]):[3,7];case 4:return[4,n.sent()];case 5:n.sent(),n.label=6;case 6:return w++,[3,3];case 7:return u.apiCallTotal+=1,h=y,[3,1];case 8:return[4,a(u)];case 9:return[2,n.sent()]}}))}))},o.defaultOrigin="https://monitoringapi.solaredge.com",o.dateFormat="yyyy-MM-dd",o.dateTimeFormat="yyyy-MM-dd HH:mm:ss",o}(),A=function(){function e(e){var t=e.apiKey,r=e.apiOrigin;this.api=new M(t,{origin:r})}return e.prototype.fetchSiteList=function(e){return void 0===e&&(e={}),r(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,this.api.call("/sites/list",{params:e})];case 1:return[2,t.sent().site]}}))}))},e.prototype.fetchSiteDetails=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){return[2,this.api.call("/site/"+e+"/details")]}))}))},e.prototype.fetchSiteDataPeriod=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){return[2,this.api.call("/site/"+e+"/dataPeriod")]}))}))},e.prototype.fetchSiteEnergyGenerator=function(t,r){var n,a=r.timeUnit,i=void 0===a?"DAY":a,o=r.dateRange;switch(i){case"QUARTER_OF_AN_HOUR":case"HOUR":n={months:1};break;default:n={years:1}}return this.api.callGenerator({apiPath:"/site/"+t+"/energy",timeUnit:i,dateRange:o,interval:n,parser:e.measurementsResponseParser})},e.prototype.fetchSitePowerGenerator=function(r,n){return this.api.callGenerator(t(t({},n),{apiPath:"/site/"+r+"/power",interval:{months:1},parser:e.measurementsResponseParser}))},e.prototype.fetchSiteCurrentPowerFlow=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){return[2,this.api.call("/site/"+e+"/currentPowerFlow")]}))}))},e.prototype.fetchSiteStorageData=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){return[2,this.api.call("/site/"+e+"/storageData")]}))}))},e.prototype.fetchSiteEnvironmentalBenefits=function(e,t){return void 0===t&&(t=!1),r(this,void 0,void 0,(function(){var r;return n(this,(function(n){return r={systemUnits:t?"Metric":"Imperial"},[2,this.api.call("/site/"+e+"/envBenefits",{params:r})]}))}))},e.prototype.fetchSiteEquipmentList=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){return[2,this.api.call("/equipment/"+e+"/list")]}))}))},e.prototype.fetchSiteEquipmentChangeLog=function(e,t){return r(this,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return[4,this.api.call("/equipment/"+e+"/"+t+"/changeLog")];case 1:return[2,r.sent().list]}}))}))},e.prototype.fetchInverterTelemetryGenerator=function(e,r,n){return this.api.callGenerator(t(t({},n),{interval:{months:1},apiPath:"/equipment/"+e+"/"+r+"/data",parser:function(e){return e.telemetries}}))},e.measurementsResponseParser=function(e){var r=e.values,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(e,["values"]);return r.map((function(e){return t(t({},n),e)}))},e}();e.SolaredgeClient=A,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=solaredge-client.min.js.map
